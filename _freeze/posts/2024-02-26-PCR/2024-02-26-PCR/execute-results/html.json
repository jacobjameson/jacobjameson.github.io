{
  "hash": "ada9a34a782480a0ef6be7cd811f0f8c",
  "result": {
    "markdown": "---\ntitle: \"Does it Spark Joy? Using PCA for Dimensionality Reduction in R\"\ndescription: \"Principal Component Analysis (PCA) is a powerful tool for dimensionality reduction. In this post, we provide an overview of PCA, explaining its purpose and how it works. We then walk through a hands-on application of PCA using R, demonstrating the step-by-step process of PCA and its application in predictive modeling.\"\nauthor: \"Jacob Jameson\"\ndate: \"2024-02-27\"\ncategories: [PCA]\noutput:\n  tufte::tufte_html: default\n  tufte::tufte_handout:\n    citation_package: natbib\n    latex_engine: xelatex\n  tufte::tufte_book:\n    citation_package: natbib\n    latex_engine: xelatex\nlink-citations: true\nreference-location: margin\ncomments:\n  utterances:\n    repo: jacobjameson/jacobjameson.github.io\nformat:\n  html:\n    toc: true\n    toc-location: left\npage-layout: full\n---\n\n\n\n\n## Understanding Principal Component Analysis (PCA)\n\nPrincipal Component Analysis (PCA) simplifies the complexity in high-dimensional data by transforming it into a new set of variables, called principal components, which capture the most significant information in the data.\n\nThe remainder of this post is organized as follows:\n\n1. **How it Works**: We provide an overview of PCA mathematically, explaining its purpose and how it works.\n\n2. **Applied Example: Navigating PCA and Predictive Modeling with R**: We walk through a hands-on application of PCA using R, demonstrating the step-by-step process of PCA and its application in predictive modeling.\n\n## How it Works\n\n#### Step 1: Standardization\n\nSuppose we have a dataset with $n$ observations and $p$ variables.\n\n$$\nX = \\begin{bmatrix} x_{11} & x_{12} & \\cdots & x_{1p} \\\\ x_{21} & x_{22} & \\cdots & x_{2p} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ x_{n1} & x_{n2} & \\cdots & x_{np} \\end{bmatrix} \n$$\n\nFirst, we standardize the data matrix $X$ to have a mean of 0 and a standard deviation of 1 for each variable. This is crucial for ensuring that all variables contribute equally to the analysis.\n\nGiven a data matrix $X$, the standardized value $z_{ij}$ of each element is calculated as:\n\n$$\nz_{ij} = \\frac{x_{ij} - \\mu_j}{\\sigma_j}\n$$\n\nwhere $\\mu_j$ is the mean and $\\sigma_j$ is the standard deviation of the $j^{th}$ column of $X$.\n\n#### Step 2: Covariance Matrix\n\nNext, we calculate the covariance matrix $C$ from the standardized data matrix $Z$. The covariance matrix reflects how variables in the dataset vary together.\n\nThe covariance matrix is calculated as:\n\n$$\nC = \\frac{1}{n-1} Z^T Z\n$$\n\nwhere $Z$ is the standardized data matrix, and $n$ is the number of observations.\n\n#### Step 3: Eigenvalue Decomposition\n\nThe eigenvalue decomposition of the covariance matrix $C$ is performed next. This step identifies the principal components of the dataset.\n\nFor the covariance matrix $C$, we find the eigenvalues $\\lambda$ and the corresponding eigenvectors $v$ by solving:\n\n$$\nCv = \\lambda v\n$$\n\n#### Step 4: Selection of Principal Components\n\nThe principal components are selected based on the eigenvalues. The eigenvectors, corresponding to the largest eigenvalues, represent the directions of maximum variance in the data.\n\nBy selecting the top $k$ principal components, we reduce the dimensionality of our data while retaining most of its variability.\n\n### Summary\n\nPCA transforms the original data into a set of linearly uncorrelated variables, the principal components, ordered by the amount of variance they capture. This process allows for the simplification of data, making it easier to explore and visualize.\n\n\n## Applied Example: Navigating PCA and Predictive Modeling with R\n\nIn this segment, we dive into a hands-on application of Principal Component Analysis (PCA) using R, aimed at simplifying and demystifying the process through a simulated dataset. Our approach mirrors the methodical steps of a college textbook, focusing on clarity, precision, and practical insights.\n\n### Generating a Simulated Dataset\n\nFirst, let's create a dataset that reflects the complexity often encountered in real data. Our simulated dataset includes:\n\n- We simulate 300 observations, ensuring a robust dataset for analysis.\n\n- Variables $X1$, $X2$, and $X3$ are created with varying degrees of noise, simulating real-world unpredictability. $X2$ and $X3$ are intentionally correlated with $X1$ but with their unique twists of randomness.\n\n- Our outcome variable y is a concoction of influences from $X1$, $X2$, and $X3$, topped with its own layer of noise.\n\n\nHere's the R code to generate this dataset:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(ggplot2)\nlibrary(plotly) # For interactive 3D plotting\nlibrary(caret)  # For PCA and regression\nlibrary(GGally) # For ggpairs\nlibrary(ggfortify) \n\nset.seed(123) # Ensuring our pretend data is the same each time\n\n# Generate our dataset\nn <- 300 # Number of observations\nX1 <- rnorm(n, mean = 50, sd = 10)\nX2 <- X1 + rnorm(n, mean = 0, sd = 25) # More noise added\nX3 <- X1 + rnorm(n, mean = 0, sd = 10) # More noise added\ny <- X1 + X2 + X3 + rnorm(n, mean = 0, sd = 30) # Increase noise in the dependent variable\n\ndata <- data.frame(X1, X2, X3, y)\n```\n:::\n\n\n### Visualizing the Data\n\nBefore applying PCA, we visually explore the dataset to understand the relationships between variables. ggpairs provides a comprehensive pairwise comparison, offering initial insights into correlations and variability among our predictors and with the outcome variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Let's peek at the relationships\nggpairs(data)\n```\n\n::: {.cell-output-display}\n![](2024-02-26-PCR_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n### 3D Visualization\n\nA 3D scatter plot further elucidates the interactions among predictors, allowing us to appreciate the dataset's complexity beyond 2D limitations..\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Interactive 3D plot to visualize relationships\nfig <- plot_ly(data, x = ~X1, y = ~X2, z = ~X3, type = 'scatter3d', mode = 'markers',\n               marker = list(size = 5, opacity = 0.5))\nfig <- fig %>% layout(scene = list(xaxis = list(title = 'X1'),\n                                   yaxis = list(title = 'X2'),\n                                   zaxis = list(title = 'X3')))\nfig\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-7916708a81fa2d585810\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7916708a81fa2d585810\">{\"x\":{\"visdat\":{\"7f491b0ad873\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"7f491b0ad873\",\"attrs\":{\"7f491b0ad873\":{\"x\":{},\"y\":{},\"z\":{},\"mode\":\"markers\",\"marker\":{\"size\":5,\"opacity\":0.5},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"xaxis\":{\"title\":\"X1\"},\"yaxis\":{\"title\":\"X2\"},\"zaxis\":{\"title\":\"X3\"}},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[44.395243534477871,47.698225105167197,65.587083141491235,50.705083914245762,51.292877351609462,67.150649868832815,54.609162059892022,37.349387653934663,43.131471481064743,45.543380299000418,62.240817974394616,53.598138270573635,54.00771450594052,51.1068271594512,44.441588652459252,67.869131368030779,54.978504782292397,30.333828433703619,57.013559015636858,45.272085922720663,39.321762940131549,47.820250853417051,39.739955516927601,42.711087707088602,43.749607321507433,33.133066892575869,58.377870444945245,51.533731178365151,38.618630629880521,62.538149210699267,54.264642214768138,47.04928517007729,58.951256610450223,58.781334875330423,58.215810816374869,56.886402541000912,55.539176535375887,49.380882894232784,46.94037336260083,46.195289989876173,43.052930210794869,47.920827219804011,37.346036484317352,71.689559653385132,62.079619983049902,38.768914167966507,45.971151647009243,45.333446463767814,57.799651183363181,49.16630933528171,52.533185139947548,49.714532446512969,49.571295427086838,63.686022840144581,47.742290143407324,65.1647060442954,34.512471957697791,55.84613749636069,51.238542438446139,52.159415687439726,53.796394827598817,44.976765468906976,46.6679261633058,39.814246168929117,39.282087735244225,53.035286414042581,54.482097786294261,50.530042267305042,59.222674678797375,70.500846856271437,45.089688339434645,26.908311243591871,60.057385244622566,42.907992374176075,43.119913835326422,60.255713696966986,47.152269929489911,37.792822877454647,51.813034797491504,48.611086375609553,50.057641858998871,53.852804011263302,46.293399682075908,56.443765485188329,47.795134381812495,53.317819639156966,60.968390131493479,54.351814908338028,46.740684144687734,61.488076184510938,59.935038559621191,55.483969595080694,52.387317351114412,43.720939239606288,63.606524485300071,43.997404128528736,71.873329930165781,65.326106261851891,47.642996408995231,39.735790996932195,42.895934363006987,52.568837091565292,47.533081215376264,46.524574006022668,40.48381432734984,49.549722751910799,42.150955305429243,33.320580634118635,46.197734797122372,59.189966090607662,44.24653037391608,56.079643222250333,33.821172917108356,49.444380344754606,55.194072039434623,53.011533621667141,51.056761941489434,43.592939916946236,41.502956539664176,39.758712093950869,51.176465971001257,40.525253858151977,45.094425562993315,47.439078078017531,68.438620052322079,43.480500983045417,52.353865722848568,50.779608495637106,40.381433658698711,49.286919138764013,64.445508584233494,54.515040530792149,50.412329219929397,45.775031676603753,29.467527784594843,61.313372134141758,35.39359929075178,57.399475108773345,69.091035692174827,35.56106839028201,57.017843353747111,47.378025105975318,34.278558408545123,34.853323462182487,33.984638264254066,44.69093477829697,35.382444150041003,56.879167729758272,71.001089405256721,37.129695239648207,57.877388474751776,57.690422410009099,53.322025789501176,39.916233917229924,48.805473933693413,47.196046648297532,55.629895332204796,46.275612438961709,59.769733866856207,46.25419142232986,60.527114655793319,39.508229933339344,37.39844755241888,82.41039934942404,45.831424118395681,52.982275915407151,56.365696740338485,45.162193742912564,55.168620443136092,53.689645273850857,47.846194923583063,50.652930335253153,49.659327462615359,71.284518990161814,42.586639037271716,39.040037329253359,50.377883991710789,53.10480749443137,54.365234789101827,45.416346672888942,39.366738660288092,62.631851760894904,46.503496120464455,41.344871373466255,47.637204310589034,48.028241056514474,61.099202897136408,50.847372921971967,57.540537851845215,45.007079828277391,52.144453095816012,46.753140885091653,50.945835281735711,41.046366420224587,36.891984666720283,69.972133847479668,56.007088236724179,37.487286383750565,43.888340833195791,38.145199154026898,71.988103488837197,63.124129764335102,47.348549433036467,55.431940592320892,45.856600520811405,45.237531053844215,42.113971621497576,44.053827325404889,66.509074673366896,49.459718749145594,51.192452364275844,52.436874295990918,62.32475878485338,44.839361690552202,40.074928496079629,66.7569693240319,45.588367830947142,42.769340300601264,37.637268811167068,37.152842776822034,44.260265207020133,56.179858171665281,61.098481389297184,57.075883538355882,46.363427029047479,50.597499373846006,42.954035363199296,42.827818384259899,58.846504989769201,39.844074213964554,69.552939654924643,49.096804060341483,52.145388266292166,42.614722952604268,44.256113102367308,36.829838676947581,48.170746116272724,54.189824049244642,53.2430434416138,42.184635129452488,42.113780291459982,44.978012816571393,64.960606698463508,38.626963793342547,48.209484056198015,69.023618216789274,48.990251146711913,36.401592961786065,43.352305647259378,54.854599789048784,46.243971283302265,44.381236364502172,46.560827658715411,50.904966471392214,65.985087711458263,49.11434887861116,60.80799496151517,56.307541156505664,48.863601044938591,34.67097997109402,44.788826824474796,45.101295468615255,50.47154432761527,63.001986776668204,72.930789738310935,65.475810589837693,48.668490356710556,32.434726044423627,46.112201359282565,50.892072230732943,58.45013004067436,59.62527968484271,56.843094294164644,36.047256502005325,58.496430456333549,45.534427835727776,51.748027001612556,50.745511771737348,54.281667649705057,50.2467498282614,33.325249024143368,57.364959647734423,53.860265683496756,47.343483747217775,51.181445110466804,51.34038645368463,52.21019468561002,66.408461659774858,47.809496210665245,51.680653838846574,61.68383873069093,60.541810233769191,61.452631103803569,44.225319989404433,70.024827302928287,50.667008709301832,68.668518447068621,36.490973139692883,50.209835863542374,62.499145709692158],\"y\":[26.514188853907967,28.881000899723645,42.123615551318892,24.392251930777352,40.363889022099492,75.430129192807357,4.2538996118740187,42.648898488241954,74.048347641478998,96.482730755011289,94.770217779409279,72.517507365472682,10.839454528082271,36.069159459281657,35.640427237893832,85.457228936953129,52.336721432198033,-1.1323872678006701,99.124451717989729,68.056868217619723,45.257519752407191,78.27296611156234,6.2705983360532827,59.231595151833616,30.676797913671884,50.226704938843682,56.85732157844339,67.357749004151415,72.006571006365334,62.720401468621738,79.703608138570445,17.338434291377816,40.91114559954984,96.76177766003488,67.650510141973115,5.5808320301576586,21.438240233316499,44.361357504504753,68.584858470963027,43.648208596995609,58.657617011311189,71.895961664499637,79.122407205890823,73.089977985259182,60.780072328527424,-5.062019810590229,48.454341499204929,31.037195016378732,33.449411613260899,44.668653559093201,77.906764458538987,-0.10417977070159878,38.889313246951119,66.601954929712235,25.412100892033497,73.512279606776033,44.798219973091058,55.020233514460898,-10.408912405554545,116.44586933410565,48.663913390893832,61.25659750859873,53.512088439219497,65.431077039387873,59.723573894596427,47.790457133329866,63.936292091506935,26.894821489207722,80.645749951280337,58.974888384162583,105.50902218413992,-14.367911148612816,48.457704170472198,63.542488943157139,55.873227507293009,45.518687734091976,22.232751374301852,41.404715495222064,51.455349468318673,3.8540554440080399,50.921418537345147,58.608561903574731,50.66155960662195,30.06833942012128,59.698466339378214,87.782073063137972,72.374300210988793,25.962103148979445,35.849547402390108,70.140666673351106,43.758897776664469,1.5428112196987698,74.49358785181964,22.983998948993335,49.267517716092996,81.594919353642112,52.51970669003066,86.469394766584287,16.125924438525857,30.872230920082753,41.057033884595029,23.352551480956404,31.664374592653527,45.803535182814805,57.251213545698093,8.2860591662830601,33.407099325147534,52.230741597755724,32.727505797682561,64.872264132431212,56.55224462552686,62.775518605542409,50.152614903892896,46.376663820320104,44.852159199631615,-13.067190179057334,48.733236479502636,54.350057325945912,54.887927561367924,25.876753311119575,95.664038715379974,47.685864348872599,48.252322024465457,79.245747564730507,50.476964519340598,32.222035384927622,112.29017772409263,51.057838176159308,81.220644193906367,13.324253015900936,59.68258853316096,63.975638121712947,57.913292850074335,20.634125188832833,29.949009650229112,34.377855806342211,53.211182421858837,84.518852355289496,13.466343279989509,66.453404947785586,25.991730933534836,58.747256830541147,50.776124362110323,29.856077759646659,17.856789342759274,48.823960309348223,46.352911667902347,78.961738228475895,19.692664807707899,-3.7797864618274062,93.637447004456362,83.85614358779776,64.204249512193229,57.795694095006432,71.7348468747185,-19.327023313344505,83.386822748175291,34.150922524903592,65.53515463263625,38.875246400240428,82.326238507761929,30.796418709449071,50.361041699625076,72.643274883449564,18.511743890858039,83.232538676413768,74.888197022195342,88.268749721823895,56.797468757618674,81.814713919555203,97.23167127406002,43.615877459278984,16.585549643734971,65.300729811708905,37.235608037637135,42.832049941986355,93.185508424692841,44.951210181797663,63.69035118422471,39.724245050500663,39.878006373413903,70.483293348551456,79.708863521389105,44.377830810735709,65.458262311366866,67.499741801102843,83.968534668527269,36.487509117362386,98.212568206712135,35.483161345927066,49.499848904572218,81.854397577945946,83.297932935375215,13.796569609943635,15.065209656283692,36.020157363214309,60.553268052219984,41.608308081712217,52.99120801707236,51.949142009490842,56.940782339211786,38.281664986867241,73.018175834909073,74.208473157478977,8.1274370875938757,42.858844782612046,19.715276052585107,-7.7149494381442167,70.262077953070474,47.479426017680886,48.758220676448822,57.840687841021733,84.386387894768063,49.979299302636868,24.664032424241423,48.386988025999869,42.293298004917617,50.519764965075055,11.64525999361603,32.545121055762436,68.44194671121798,53.472855890803125,43.637964699437433,50.177254327717392,74.229640663096973,64.348598404199407,73.870930365239431,46.305264813304177,69.103382402029823,25.882651405261232,84.687206378182964,36.438465505610495,16.631250648898558,45.814547094707414,92.902393545653197,56.852697166274119,77.302080864929223,63.161217126573447,38.029113983708193,37.128613751695397,35.282577621161849,33.260518322019216,82.564788796706409,8.692876234207251,69.868637359017356,90.627430372436606,19.024692169993198,52.388892909299408,104.10797195587209,40.92421274050858,67.366577318504056,24.826190224017086,74.328613113785437,57.150584469556279,107.28297250203738,12.640080665188272,59.525547808381141,43.134411753365718,43.931979318031111,18.931511403943897,23.94273731109978,59.569354834026498,23.282026475692096,100.10276006557528,43.275625105467171,68.002789374719683,61.993222527372573,47.103109521739256,38.568534762623059,52.879622113942972,82.481733835916287,23.213631757932063,37.299601505862597,44.057314359920582,47.376880997908756,79.784527685002772,68.579373585483438,52.549680582106241,16.587734711288057,50.899255461417447,25.414852319218539,54.806296809719477,24.32128500710462,59.809934842965887,25.207534102790977,45.684836917624388,61.745840421893831,46.820566934448664,62.384281352666861,18.767893797554265,-8.5605282433226151,72.166010003415508,82.466126777828563,37.079184399619834,82.627983667718496,21.769095582210049,65.489803276427068,-12.046986261322566,79.739358149505421,108.99691724827119],\"z\":[55.135366137297765,47.424755441029781,65.253779718732048,35.544407682734771,59.196730790491742,65.043308061915056,48.041732806281267,23.229129727351577,40.13384651460202,37.052768948833332,58.270512771116252,41.422138392937654,70.883609335397495,50.946801887371514,55.191039425183114,41.852134665454258,50.446526482344019,23.57900551778291,44.784297221977724,60.738177464961609,25.168943742436646,51.004153457497303,48.204318372724522,44.492989591268831,34.997052546552275,42.544724959817543,60.083751263353626,40.89875211454472,24.738140153859909,83.405323555630744,47.479610760583768,28.493568630896888,64.283850237986741,61.883637435939377,44.677467459148886,37.456838405181415,54.37615136378983,60.774845811327005,53.301613714422317,41.265915748256397,34.711047894951093,50.631494787309464,38.919569956478931,77.986677120312407,58.121640480160941,47.762454699997505,37.663036373646761,42.027999462568182,65.20779642062223,59.066025421552837,33.148138125413752,50.786436516674499,55.65908554443314,49.177779705238265,52.548546142159495,56.882963340327429,44.715002079342078,61.2309578173871,58.929065388402236,53.366608980310069,62.432879169176353,58.781910752052354,66.330406317862128,39.530295621438469,16.791576831920182,53.350546459982496,56.537709870794011,48.976588795861055,64.905560886568125,80.607626501414089,39.909864037756428,23.967357972030769,64.03580733262595,37.405754959284693,44.032587670208777,40.638637708113961,35.953272715513663,24.515268121413392,43.276797830219088,41.678041096302898,53.880693284462566,63.673934036489712,39.019564391200554,46.475375661408279,37.378245791917401,49.171932375520228,58.578099449967837,59.187990246720723,43.527435723003833,40.703183495910707,59.020695804119811,67.355837701596258,64.303330036217659,35.831307058493991,48.128759048924366,68.578009047181467,70.24911050537159,64.351593760795723,51.848738295976702,23.595396430741001,35.613743251094114,37.164413038665202,40.602135075270311,47.713068336068275,26.836719747480718,55.449549545583928,45.044395593602601,24.278430377912244,48.460984220933007,66.670777715546095,54.857482906533498,53.951160435785056,32.884804977997902,48.577238994935357,69.60868959998507,64.26225254444708,59.400777619059824,40.71953191853931,45.235370881328237,43.791615406157831,40.75973302810803,23.242208704944549,51.512725839509478,32.145972766213305,68.455456937164172,45.982979196528724,57.992539625907405,52.673870870785215,33.052895595727463,59.150577737718628,81.83184625329595,63.326828620046577,30.97582020668964,59.770793530633192,28.906968322732162,66.562514927334661,41.61393164946238,56.43261437670629,68.338403715687562,45.752639083591006,64.133862578609552,57.280647566417628,58.107825360848395,41.49748209912336,36.058449838107137,22.584603672540762,62.299584182502159,52.052399511795194,94.748436556210663,40.876130919698085,73.261690463719717,56.593319198246711,58.436733336482433,42.05581371365254,46.94426693995846,45.992108402072596,65.758238690647346,44.261030969246711,39.392908922448207,44.295298934031585,65.925020711156066,45.672787096853739,43.564125727193222,65.489384140733222,49.518844698507621,62.660868014877785,69.131483555015052,42.912581032471408,51.94969458130808,68.568023592631249,31.166914465789866,46.284630566121905,54.233948256189905,55.106781336349556,45.382917661589289,57.818677539775294,50.337277457347383,50.320267244795509,59.114351929442371,42.625624965015874,47.500742401078739,71.676206405391852,46.530412732765662,29.577949795968983,34.454997035998154,42.098267399961308,69.073007902634771,31.265321175402715,38.677286264519758,38.469281580676366,56.088401575621859,37.617480403441732,59.813325652696307,44.380066121776409,35.185588484334183,78.16041521279746,59.890739864917855,33.027936111629003,46.199490177377392,44.620332733802812,75.550936937457664,56.544027684840316,55.900571483678384,66.961302847907049,48.619346086244768,46.678577678466084,41.357720813699196,65.667985788432759,69.272229994724825,47.876778462146156,26.113274342303299,36.784056645685595,61.548026778747733,46.902302138983181,42.843653084695774,74.972037128518082,43.646843737742579,54.915228245426889,28.422108382471286,25.06841557239137,31.970403431481991,63.60282841353046,60.269281965904923,64.974062756560869,43.686362813476634,44.678578351717881,39.270509611934237,24.301650141842607,47.150352385628054,25.423727750380053,80.09616237467813,43.123503146713482,60.039986794193965,57.779628969523849,42.338365011267889,39.668627740471095,30.660070922311938,46.003126274046615,53.805191935442188,45.175504162814008,34.519799118471163,71.826602808839382,60.376705307539623,39.269399359642925,54.707402727733196,68.763431869049327,42.554577276440774,46.854649601419112,59.507758879331391,54.557660078550427,51.866644737332926,43.407111379475872,56.72537983573703,39.343292528793683,89.19368995140303,43.079036400727787,46.219500817134247,52.798362884574971,50.330685886388608,50.907192047896309,53.900923592187993,46.525879789073123,36.576709087733668,54.341609329947062,71.297940416017994,91.006071724443615,30.066214614526409,43.745272562883841,40.839858786943353,67.551981230607126,47.058123640940309,61.061512031470187,45.84758487713713,45.082420765622075,73.334225343714408,65.0416378997393,59.72403357750774,69.178174317515555,66.745906736321515,48.928000710021252,38.095621406990368,47.645017532975089,52.008243989486814,59.553120830705993,56.594286545290309,55.913959769937932,41.828884288737967,60.363329356433688,40.16343607312956,55.633612538981566,51.778762426025338,66.162224134759711,50.288466984468144,62.510624570758083,74.630740797709322,43.656972586769136,71.078977772080847,32.96644114741332,53.921315461138946,64.934472897295166],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(31,119,180,1)\",\"size\":5,\"opacity\":0.5,\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"type\":\"scatter3d\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"line\":{\"color\":\"rgba(31,119,180,1)\"},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\n\nIsn't that cool? Visualizing data in 3D can offer insights that are not immediately obvious in 2D plots, providing a richer understanding of our dataset's structure.\n\n### Simplifying Complexity with PCA\n\nWith PCA, we aim to reduce the dataset's dimensionality by identifying principal components that capture the most variance. This step simplifies the dataset, making subsequent analyses more manageable.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform PCA\npca_result <- prcomp(data[,1:3], center = TRUE, scale. = TRUE)\n\n# Let's see the summary of our PCA to understand the variance explained\nsummary(pca_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nImportance of components:\n                          PC1    PC2    PC3\nStandard deviation     1.3418 0.9338 0.5723\nProportion of Variance 0.6002 0.2907 0.1092\nCumulative Proportion  0.6002 0.8908 1.0000\n```\n:::\n\n```{.r .cell-code}\n# And visualize the PCA\nautoplot(pca_result, data = data, colour = 'y', frame = TRUE, frame.type = 'norm')\n```\n\n::: {.cell-output-display}\n![](2024-02-26-PCR_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nThe summary and plot from PCA show us how much of the total variance is captured by each principal component. This step is crucial as it guides us in deciding how many components to retain for our predictive modeling.\n\n## Predictive Modeling: Principal Component Regression (PCR)\n\nWe split the dataset into training and testing sets, apply PCA to the training data, and use the resulting principal components for regression modeling. This method, known as Principal Component Regression (PCR), leverages simplified data to predict the outcome variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Split data into training and testing sets\ntrainingIndex <- createDataPartition(data$y, p = .8, list = FALSE)\ntrainingData <- data[trainingIndex, ]\ntestingData <- data[-trainingIndex, ]\n\n# Perform PCA on training data\npca_train <- prcomp(trainingData[,1:3], center = TRUE, scale. = TRUE)\n\n# Use PCA for predictions, keeping first two components\npredictors <- predict(pca_train, newdata = testingData[,1:3])[,1:2]\n\n# Preparing data for modeling\nmodelingData <- as.data.frame(predictors)\nmodelingData$y <- testingData$y\n\n# Fit the linear model\nmodel <- lm(y ~ ., data = modelingData)\n\n# Model summary\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ ., data = modelingData)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-79.508 -22.445  -0.581  17.044  59.142 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  150.142      3.924  38.261  < 2e-16 ***\nPC1           24.580      2.969   8.280 2.36e-11 ***\nPC2           16.705      4.332   3.856 0.000295 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 30.06 on 57 degrees of freedom\nMultiple R-squared:  0.5958,\tAdjusted R-squared:  0.5817 \nF-statistic: 42.02 on 2 and 57 DF,  p-value: 6.123e-12\n```\n:::\n\n```{.r .cell-code}\n# Predict and calculate RMSE\npredictions <- predict(model, newdata = modelingData)\nrmse <- sqrt(mean((predictions - testingData$y)^2))\nprint(paste(\"RMSE:\", rmse))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"RMSE: 29.301351513265\"\n```\n:::\n:::\n\n\n### Comparing with Traditional Regression\n\nWe contrast PCR's performance with a traditional regression model using all predictors. This comparison assesses whether PCA's dimensionality reduction impacts predictive accuracy.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Traditional linear regression model\nfull_model <- lm(y ~ X1 + X2 + X3, data = trainingData)\nsummary(full_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ X1 + X2 + X3, data = trainingData)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-77.406 -21.676  -0.272  17.163  92.270 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -6.59698   10.85595  -0.608   0.5440    \nX1           0.89290    0.29335   3.044   0.0026 ** \nX2           1.17467    0.08144  14.423  < 2e-16 ***\nX3           1.09015    0.19330   5.640 4.85e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 30.95 on 236 degrees of freedom\nMultiple R-squared:  0.6437,\tAdjusted R-squared:  0.6392 \nF-statistic: 142.1 on 3 and 236 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\n# Prediction and RMSE calculation\nfull_predictions <- predict(full_model, newdata = testingData)\nfull_rmse <- sqrt(mean((full_predictions - testingData$y)^2))\nprint(paste(\"Full Model RMSE:\", full_rmse))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Full Model RMSE: 28.7829853245021\"\n```\n:::\n:::\n\n\n\n### Insights and Reflections\n\n- PCA Summary: Reveals PC1 as the major variance holder, suggesting much of the data's information is concentrated here.\n\n- PCR vs. Traditional Regression: Comparing models shows how PCA can reduce dimensionality of the data without significantly compromising on predictive power. While PCR focuses on the essence of data, traditional regression considers all details, including noise.\n\n- Practical Implications: This exercise demonstrates PCA's value in simplifying complex datasets, potentially enhancing model interpretability and efficiency.\n\n## Conclusion\n\nPrincipal Component Analysis (PCA) is a powerful tool for simplifying complex datasets, reducing dimensionality, and enhancing predictive modeling. By identifying principal components that capture the most variance, PCA transforms the original data into a set of linearly uncorrelated variables, making it easier to explore and visualize. In this tutorial, we applied PCA to a simulated dataset and used Principal Component Regression (PCR) to predict an outcome variable, comparing its performance with traditional regression. The results underscore PCA's potential to streamline data and improve predictive accuracy, offering practical insights for real-world applications.\n\nThank you!\n\n\n",
    "supporting": [
      "2024-02-26-PCR_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}